<span [ngClass]="{ 'type': element.ShowTitle, 'hidden': !element.ShowTitle}">{{ element.Type }}</span>
<span class="type" *ngIf="element != null && element.Type == 'main' && preview" (click)="preview = !preview" style="background-color: transparent;">
    <div class="tool-button" *ngIf="element != null && (element.Type == 'main')" (click)="preview = !preview" style="display: inline-block;">
        <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
            <path fill="none" stroke-width="2.93" d="M40 5C26.754 6.667 16 15.055 16 25s10.754 18.333 24 20c13.246-1.667 24-10.055 24-20S53.246 6.667 40 5Z" transform="matrix(0 1 -2.2 0 105 10)"/>
            <ellipse cx="51" cy="54.5" fill="none" stroke-width="2.94" rx="9" ry="13.5" transform="matrix(2 0 0 1.33333 -52 -22.667)"/>
            <ellipse cx="51" cy="50" rx="6" ry="8" transform="matrix(1.33333 0 0 1 -18 0)"/>
        </svg>
        <span class="tooltiptext">Close Preview</span>
    </div>
</span>
<div
    *ngIf="!preview"
    [ngClass]="{ 'border': element.Type != 'main', 'border-main': element.Type == 'main', 'selected': element.Selected }"
    (mouseenter)="ShowTitle($event, element)"
    (mouseleave)="ShowTitle($event, element)">
    <div class="main-container">
        <header (click)="Select()">
            <div class="tool-button" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container' || element.Type == 'columns')" (click)="ShowMenu()">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
                    <path d="M56 8c0-1.656-1.344-3-3-3h-6c-1.656 0-3 1.344-3 3v84c0 1.656 1.344 3 3 3h6c1.656 0 3-1.344 3-3V8Z"/>
                    <path d="M92 56c1.656 0 3-1.344 3-3v-6c0-1.656-1.344-3-3-3H8c-1.656 0-3 1.344-3 3v6c0 1.656 1.344 3 3 3h84Z"/>
                </svg>
                <span class="tooltiptext">Add</span>
            </div>
            <div class="tool-button" *ngIf="element != null && (element.Type != 'main')" (click)="Delete()">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
                    <path d="M21 29c.085-.394 58.229-.352 58 0-.229.352-6 68-6 68H27s-6.085-67.606-6-68ZM20.999 22h58.002v3H20.999zM40 17h20v5H40z"/>
                    <path fill="#84c6ff" d="M54 36a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v55a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V36ZM38 36a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v55a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V36ZM70 36a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v55a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V36Z"/>
                </svg>
                <span class="tooltiptext">Delete {{ element.Type }}</span>
            </div>
            <div class="tool-button" *ngIf="element != null && (element.Type != 'main')" (click)="Move(true)">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
                    <path d="M53.363 27.372a3.001 3.001 0 0 0-4.242 0l-4.243 4.243a3.001 3.001 0 0 0 0 4.243l36.77 36.77a3.001 3.001 0 0 0 4.242 0l4.243-4.243a3.001 3.001 0 0 0 0-4.243l-36.77-36.77Z"/>
                    <path d="M55.122 35.858a3.001 3.001 0 0 0 0-4.243l-4.243-4.242a3.001 3.001 0 0 0-4.242 0l-36.77 36.77a3.001 3.001 0 0 0 0 4.242l4.243 4.242a3.001 3.001 0 0 0 4.242 0l36.77-36.77Z"/>
                </svg>
                <span class="tooltiptext">Move up {{ element.Type }}</span>
            </div>
            <div class="tool-button" *ngIf="element != null && (element.Type != 'main')" (click)="Move(false)">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
                    <path d="M46.637 72.628a3.001 3.001 0 0 0 4.242 0l4.243-4.243a3.001 3.001 0 0 0 0-4.243l-36.77-36.77a3.001 3.001 0 0 0-4.242 0l-4.243 4.243a3.001 3.001 0 0 0 0 4.243l36.77 36.77Z"/>
                    <path d="M44.878 64.142a3.001 3.001 0 0 0 0 4.243l4.243 4.242a3.001 3.001 0 0 0 4.242 0l36.77-36.77a3.001 3.001 0 0 0 0-4.242l-4.243-4.242a3.001 3.001 0 0 0-4.242 0l-36.77 36.77Z"/>
                </svg>
                <span class="tooltiptext">Move down {{ element.Type }}</span>
            </div>
            <div class="tool-button" *ngIf="element != null && (element.Type == 'main')" (click)="preview = !preview">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 100 100">
                    <path fill="none" stroke-width="2.93" d="M40 5C26.754 6.667 16 15.055 16 25s10.754 18.333 24 20c13.246-1.667 24-10.055 24-20S53.246 6.667 40 5Z" transform="matrix(0 1 -2.2 0 105 10)"/>
                    <ellipse cx="51" cy="54.5" fill="none" stroke-width="2.94" rx="9" ry="13.5" transform="matrix(2 0 0 1.33333 -52 -22.667)"/>
                    <ellipse cx="51" cy="50" rx="6" ry="8" transform="matrix(1.33333 0 0 1 -18 0)"/>
                </svg>
                <span class="tooltiptext">Preview</span>
            </div>
            <div [ngClass]="{ 'tool-menu': true, 'hidden': hideMenu }" (mouseleave)="ShowMenu()">
                <div class="button" (click)="Add('columns')" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container')">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" clip-rule="evenodd" viewBox="0 0 385 139">
                        <path d="M112.5 12c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM112.5 62c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM112.5 112c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15ZM242.5 12c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM242.5 62c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM242.5 112c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15ZM372.5 12c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM372.5 62c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM372.5 112c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15Z"/>
                    </svg>
                    <span>Columns</span>
                </div>
                <div class="button" (click)="Add('column')" *ngIf="element != null && element.Type == 'columns'">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" clip-rule="evenodd" viewBox="0 0 385 139">
                        <path d="M112.5 12c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM112.5 62c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM112.5 112c0-4.139-3.36-7.5-7.5-7.5H20c-4.14 0-7.5 3.361-7.5 7.5v15c0 4.139 3.36 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15ZM242.5 12c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM242.5 62c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM242.5 112c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15ZM372.5 12c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V12ZM372.5 62c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5V62ZM372.5 112c0-4.139-3.36-7.5-7.5-7.5h-85c-4.139 0-7.5 3.361-7.5 7.5v15c0 4.139 3.361 7.5 7.5 7.5h85c4.14 0 7.5-3.361 7.5-7.5v-15Z"/>
                    </svg>
                    <span>Column</span>
                </div>
                <div class="button" (click)="Add('text')" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container')">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 349.078 349.078">
                        <path d="M198.779 322.441v-58.245c0-7.903 6.406-14.304 14.304-14.304 28.183 0 43.515-28.904 45.643-85.961h-45.643c-7.897 0-14.304-6.41-14.304-14.304V26.64c0-7.9 6.406-14.301 14.304-14.301h121.69c7.896 0 14.305 6.408 14.305 14.301v122.988c0 27.349-2.761 52.446-8.181 74.611-5.568 22.722-14.115 42.587-25.398 59.049-11.604 16.917-26.132 30.192-43.155 39.437-17.152 9.304-37.09 14.026-59.267 14.026-7.891-.006-14.298-6.413-14.298-14.31zM14.301 249.887C6.404 249.887 0 256.293 0 264.185v58.257c0 7.896 6.404 14.298 14.301 14.298 22.166 0 42.114-4.723 59.255-14.026 17.032-9.244 31.558-22.508 43.161-39.437 11.29-16.462 19.836-36.328 25.404-59.061 5.423-22.165 8.178-47.263 8.178-74.6V26.628c0-7.9-6.41-14.301-14.304-14.301H14.301C6.404 12.327 0 18.734 0 26.628v122.988c0 7.899 6.404 14.304 14.301 14.304h45.002c-2.102 57.062-17.213 85.967-45.002 85.967z"/>
                    </svg>
                    <span>Text</span>
                </div>
                <div class="button" (click)="Add('button')" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container')">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5" clip-rule="evenodd" viewBox="0 0 347 159">
                        <path stroke-width="10" fill="none" d="M340 134.25c0-18.351-16.538-33.25-36.909-33.25H43.909C23.538 101 7 115.899 7 134.25v66.5C7 219.101 23.538 234 43.909 234h259.182C323.462 234 340 219.101 340 200.75v-66.5Z" transform="matrix(1.00924 0 0 1.1203 -2.065 -108.15)"/>
                        <text x="62" y="209" font-family="'ArialMT','Arial',sans-serif" font-size="102.852" transform="matrix(.92301 0 0 .925 -20.164 -73.819)">Button</text>
                    </svg>
                    <span>Button</span>
                </div>
                <div class="button" (click)="Add('title')" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container')">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" clip-rule="evenodd" viewBox="0 0 203 83">
                        <text x="32" y="209" font-family="'ArialMT','Arial',sans-serif" font-size="122.852" transform="matrix(.92301 0 0 .925 -32.194 -111.981)">H<tspan x="102.484px 129.778px" y="209px 209px">1</tspan></text>
                    </svg> 
                    <span>Title</span>
                </div>
                <div class="button" (click)="Add('image')" *ngIf="element != null && (element.Type == 'main' || element.Type == 'container')">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="1.5" clip-rule="evenodd" viewBox="0 0 383 455">
                        <path fill="none" stroke-width="60" d="M182 18h262v571H182z" transform="matrix(1.44275 0 0 .7881 -260.08 -11.686)"/>
                        <path stroke-width="0" d="m32 396 319 1-52-268-114 153-59-59.556L32 396Z"/>
                    </svg>
                    <span>Image</span>
                </div>
            </div>
        </header>
        <div [ngClass]="{ 'container': true, 'vertical': element.VerticalOrientation, 'horizontal': !element.VerticalOrientation }">
            <app-block-editor
                *ngFor="let e of element.Childrens"
                [element]="e"
                (ondeleting)="DeleteChildren($event)"
                (onselecting)="SelectChildren($event)"
                (onsaved)="SavedChildren($event)"
                (onmousenterchild)="MouseChild($event)"
                (onmousleavechild)="MouseChild($event)"
                (onmove)="MoveChildren($event)"></app-block-editor>
            <ng-container [ngSwitch]="element.Type">
                <h1 *ngSwitchCase="'title'" [innerHTML]="element.Content"></h1>
                <button *ngSwitchCase="'button'" [innerHTML]="element.Content"></button>
                <p *ngSwitchCase="'text'" [innerHTML]="element.Content"></p>
                <img *ngSwitchCase="'image'" src="{{ element.Content }}" height="100">
            </ng-container>
        </div>
    </div>
    <div class="properties-bar" *ngIf="element.Type == 'main'">
        <form *ngIf="element != null && element.Type == 'main'" [formGroup]="frmGroup" method="post" (ngSubmit)="onSubmit()">
            <label *ngIf="selectedElement != null">Edit {{ selectedElement.Type }}</label>
            <ng-container *ngIf="selectedElement != null && selectedElement.Type == 'main'">
                <app-form-control
                    [label]="'* Page name'"
                    [controlName]="'name'"
                    [frmGroup]="frmGroup"></app-form-control>
                <app-form-control
                    [label]="'* Route'"
                    [controlName]="'route'"
                    [controlType]="2"
                    [dataList]="routes"
                    [descField]="'Path'"
                    [frmGroup]="frmGroup"></app-form-control>
            </ng-container>
            <ng-container *ngIf="selectedElement != null && selectedElement.Type != 'main'">
                <app-form-control
                    [label]="'Id (off) or class (on)'"
                    [controlName]="'class'"
                    [controlType]="6"
                    [frmGroup]="frmGroup"></app-form-control>
                <app-form-control
                    [label]="'Id'"
                    [controlName]="'id'"
                    [frmGroup]="frmGroup"></app-form-control>
                <app-form-control
                    *ngIf="selectedElement.Type == 'title' || selectedElement.Type == 'button' || selectedElement.Type == 'text'"
                    [label]="'Content'"
                    [controlName]="'text'"
                    [controlType]="3"
                    [frmGroup]="frmGroup"></app-form-control>
                <app-form-control
                    *ngIf="selectedElement.Type == 'image'"
                    [label]="'Image'"
                    [controlName]="'image'"
                    [controlType]="8"
                    (onFileChanged)="onFileChanged($event)"
                    [frmGroup]="frmGroup"></app-form-control>
            </ng-container>
            <button type="submit" class="btn unselectable mt-1" [disabled]="frmGroup.invalid" *ngIf="selectedElement != null">
                <span *ngIf="selectedElement != null && selectedElement.Type == 'main'">Save page</span>
                <span *ngIf="selectedElement != null && selectedElement.Type != 'main'">Save component</span>
            </button>
        </form>
    </div>
</div>
<app-custom-view *ngIf="preview" [element]="element" [preview]="true"></app-custom-view>